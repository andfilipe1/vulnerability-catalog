/* home-generator.js:
 * Get data and generate the graphical elements to home page.
 */

/* Vulnerability bar: */
url = "/catalog/vulnerability/data/json/filter/?field=risk"

// updating the progress-bar elements: //
var data;
d3.json(url, function(d) {
    data = d;

    for (var i in data) {
      var field = data[i].risk;
      var value = data[i].vulnerabilities;

      // updating the progrees bar attributes:
      var bar = d3.select("#vulnerabilityBar")
          .append("div")
          .attr("class", function(d) { if (field == "High") {
                                           return "progress-bar bg-danger"
                                       } else if (field == "Medium") {
                                           return "progress-bar bg-warning"
                                       } else if (field == "Low") {
                                           return "progress-bar bg-secondary"
                                     } })
          .attr("role", "progressbar")
          .style("width", function(d) { return value + "%"; })
          .attr("aria-valuenow", value)
          .attr("data-toggle", "tooltip")
          .attr("title", value)
          .text(field);
    }

});
