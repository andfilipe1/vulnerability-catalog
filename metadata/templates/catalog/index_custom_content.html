<script>
  function nextPage() {
    var url = window.location.href;
    var url = new URL(url); //it avoids 'url.searchParams is undefined'
    var start = url.searchParams.get("start");
    var stop = url.searchParams.get("stop");

    var steps = 10; //10 entries per table in the default mode.

    console.log(start);
    if (start) {
      start = parseInt(start) + parseInt(steps);
      start = String(start);

      url = "{% url 'catalog:index' %}?start=" + start;
    };

    if (stop) {
      stop = parseInt(stop) + parseInt(steps);
      stop = String(stop);
      url = "{% url 'catalog:index' %}?start=" + start + "&stop=" + stop;
    };

    location.assign(url);

  };

  function previousPage() {
    var url = window.location.href;
    var url = new URL(url); //it avoids 'url.searchParams is undefined'
    var start = url.searchParams.get("start");
    var stop = url.searchParams.get("stop");

    var steps = 10; //10 entries per table in the default mode.

    console.log(start);
    if (start) {
      start = parseInt(start) - parseInt(steps);
      start = String(start);

      url = "{% url 'catalog:index' %}?start=" + start;
    };

    if (stop) {
      stop = parseInt(stop) - parseInt(steps);
      stop = String(stop);
      url = "{% url 'catalog:index' %}?start=" + start + "&stop=" + stop;
    };

    location.assign(url);

  };
</script>

<div class="container-fluid">
<h3>These are your latest <strong>identified</strong> vulnerabilities:</h3>
</div>
<!-- Pagination -->
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    <li class="page-item">
      <a onclick="previousPage()" class="page-link" href="#">Previous</a>
    </li>
    <li class="page-item">
      <a onclick="nextPage()" class="page-link" href="#">Next</a>
    </li>
  </ul>
</nav>
<!-- End of Pagination. --> 

<!-- vulnerability summary table. --> 
<div class="container-fluid justify-content-center">
    <div class="table">
        <table class="table-responsive table-hover table-bordered">
        <thead class="thead-default">
        <tr>
            <th>id</th>
            <th>System</th>
            <th>Vulnerability</th>
            <th>Owner</th>
            <th>Risk</th>
            <th>Status</th>
            <th>Remediation time remaining (days)</th>
            <th>Remediation deadline</th>
            <th>Identification date</th>
        </tr>
        </thead>
        {% for vulnerability in vulnerability_list %}
            <tr data-toggle="tooltip" title="Click to edit this entry" onclick='location.href="/catalog/vulnerability/detail/{{ vulnerability.id }}/"'>
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.id }}</a></td>
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.system }}</a></td>
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.vulnerability }}</a></td>
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.owner }}</a></td>
                {% if vulnerability.risk == "High" %}
                    <td bgcolor="salmon"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.risk }}</a></td>
                {% elif vulnerability.risk == "Medium" %}
                    <td bgcolor="lightpink"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.risk }}</a></td>
                {% elif vulnerability.risk == "Low" %}
                    <td bgcolor="khaki"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.risk }}</a></td>
                {% endif %}
                {% if vulnerability.status == "Solved" %}
                    <td bgcolor="lightgreen"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.status }}</a></td>
                {% else %}
                    <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.status }}</a></td>
                {% endif %}
                {% if vulnerability.remediation_time_remaining > 0 or vulnerability.status == "Solved" %}
                    <td bgcolor="lightgreen"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.remediation_time_remaining }}</a></td>
                {% else %}
                    <td bgcolor="salmon"><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.remediation_time_remaining }}</a></td>
                {% endif %}
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.remediation_deadline }}</a></td>
                <td><a href="/catalog/vulnerability/detail/{{ vulnerability.id }}/">{{ vulnerability.identification_date }}</a></td>
            </tr>
        {% endfor %}
        </table>
    </div>
</div>
<!-- End of vulnerability summary table. --> 
