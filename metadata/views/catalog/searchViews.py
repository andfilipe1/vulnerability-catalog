from django.views.generic import View
from django.core import serializers
from django.http import HttpRequest, HttpResponse

from django.http import HttpResponseForbidden
from django.http import HttpResponseNotFound

from django.db.models import Q

import json

from .models import Vulnerability

class SearchView(View):
    model = Vulnerability

    def get_data(HttpRequest, q=None):
        if not HttpRequest.user.is_authenticated:
            return HttpResponseForbidden()

        field = HttpRequest.POST.get('q')
        if not field:
            return HttpResponseNotFound("No results found.")

        #### Parsing data to enable complex search filter:
        data = field.split()
        if len(data) > 1:
            search_filter = list()
            for i in data:
                search_filter.append(i.split('='))
            return HttpResponse(search_filter)
        else:
            return HttpResponse(data)
 
