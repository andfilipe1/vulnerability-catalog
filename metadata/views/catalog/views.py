from django.shortcuts import render

# Create your views here.
from django.shortcuts import get_object_or_404, render
from django.http import HttpResponseRedirect
from django.urls import reverse
from django.views import generic

from django.core import serializers
from django.http import HttpResponse
from django.http import JsonResponse

from .models import Vulnerability


class IndexView(generic.ListView):
    template_name = 'catalog/index.html'
    context_object_name = 'vulnerability_list'

    def get_queryset(self):
        return Vulnerability.objects.order_by('-identification_date')

class DetailView(generic.DetailView):
    model = Vulnerability
    template_name = 'catalog/detail.html'

class PanoramaView(generic.ListView):
    model = Vulnerability
    template_name = 'panorama/index.html'

class DataView(generic.ListView):
    model = Vulnerability
    template_name = 'data/index.html'

    def get_data(request):
        qs = Vulnerability.objects.values()
#        qs_json = serializers.serialize('json', qs)
#        return JsonResponse(qs_json, content_type='application/json', safe=False)
#        return JsonResponse(qs_json, content_type='application/json')
#        return HttpResponse(qs_json, content_type='application/json')
        return HttpResponse(qs, content_type='application/json')
